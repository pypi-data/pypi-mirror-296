import{d as k,i as F,b as g,c as _,o as $,m as G,V as ve,e as x,f as c,t as w,W as fe,r as M,X as I,K as j,Y as T,M as Z,_ as W,Z as ge,I as _e,w as U,v as X,z as J,A as he,h as ye,$ as Ce,F as be,s as Ie,n as Q,p as ee,k as te,u as Y,j as Se,q as Pe,U as $e}from"./index-DStp1AYb.js";const Ee=10,Te=k({__name:"ChildlessPlaceholder",props:{componentId:{type:String,required:!0}},setup(a){const n=F(g.core),u=a,l=(y,r)=>{const b=y.map(e=>n.getComponentDefinition(e)).map(e=>e==null?void 0:e.name);return`${b.slice(0,-1).join(", ")} ${b.length>1?r:""} ${b.at(-1)}`},s=_(()=>{const y=n.getContainableTypes(u.componentId);let r;return y.length<=Ee&&(r=`You can add ${l(y,"and")} components`),r});return(y,r)=>($(),G(ve,{class:"ChildlessPlaceholder","component-id":a.componentId,message:s.value},null,8,["component-id","message"]))}}),we={class:"RenderError"},Me={class:"title"},Be={class:"message"},De=k({__name:"RenderError",props:{componentType:{},message:{}},setup(a){const n=a;return(u,l)=>($(),x("div",we,[c("div",Me,[c("h2",null,"Error rendering "+w(n.componentType),1)]),c("div",Be,w(n.message),1)]))}});function xe(a){return a.map(n=>`${n.componentId}:${n.instanceNumber}`).join(",")}function tt(a){return a?a.split(",").map(n=>{const[u,l]=n.split(":");return{componentId:u,instanceNumber:Number(l)}}):[]}const Fe={props:{componentId:{type:String,required:!0},instancePath:{type:Array,required:!0},instanceData:{validator:()=>!0,required:!0}},setup(a){const n=F(g.core),u=F(g.builderManager),l=a.componentId,s=_(()=>n.getComponentById(l)),y=fe(s.value.type),r=a.instancePath,S=a.instanceData,{getEvaluatedFields:b,isComponentVisible:P}=Z(n),e=b(r),m=_(()=>n.getComponents(l,{sortedByPosition:!0})),p=_(()=>!!u&&u.getMode()!="preview"),A=_(()=>p.value&&!s.value.isCodeManaged&&s.value.type!=="root"),B=(t,o)=>(t?n.getContainableTypes(t):["root"]).includes(o),E=M(!1),se=_(()=>n.getUserFunctions()),oe=()=>{if(!(m.value.length>0))return T(Te,{componentId:s.value.id})},L=(t,o=0,d={})=>T(ne,{componentId:t,key:`${t}:${o}`,instancePath:[...r,{componentId:t,instanceNumber:o}],instanceData:[...S,M(null)],...d}),ae=t=>o=>{if(!B(l,o.type)&&t==="default")return!0;const i=n.getComponentDefinition(o.type).slot??"default";return i==="*"||i===t},K=(t=0,o="default",d=()=>!0,i=!1)=>{const v=f=>!p.value||i?[]:[T("div",{"data-writer-slot-of-id":l,"data-writer-position":f})],h=m.value.filter(ae(o)).filter(d),C=h.filter(f=>!f.isCodeManaged).map(f=>L(f.id,t,{contextSlot:o})),D=h.filter(f=>f.isCodeManaged).map(f=>L(f.id,t,{contextSlot:o}));return[...v(0),...C.map((f,V)=>[f,v(V+1)]).flat(),...D]},q=xe(r);I(g.evaluatedFields,e),I(g.componentId,l),I(g.isBeingEdited,p),I(g.isDisabled,E),I(g.instancePath,r),I(g.instanceData,S),I(g.renderProxiedComponent,L),I(g.getChildrenVNodes,K),I(g.flattenedInstancePath,q);const re={"data-writer-id":l,"data-writer-instance-path":q},N=M(!1);j(()=>(u==null?void 0:u.getSelectedId())==l,t=>{N.value=t}),j(()=>e,()=>{N.value=!1},{deep:!0});const z=_(()=>m.value.length==0),le=_(()=>P(l,r)),ie=(t,o)=>{if(!t.startsWith("$")&&!o)return i=>{let v=!1;se.value.some(h=>h.name==t&&h.args.includes("payload"))&&(v=!0),n.forwardEvent(i,r,v)};if(t.startsWith("$goToPage_")){const i=t.substring(10);return v=>n.setActivePageFromKey(i)}return null},ce=_(()=>{const t={},o=Object.keys(s.value.handlers??{}),d=s.value.binding?[s.value.binding.eventType]:[];return Array.from(new Set([...o,...d])).forEach(v=>{var D;const h=`on${v.charAt(0).toUpperCase()}${v.slice(1)}`,C=v===((D=s.value.binding)==null?void 0:D.eventType);t[h]=f=>{var O,H;C&&n.forwardEvent(f,r,!0);const V=(O=s.value.handlers)==null?void 0:O[v];V&&((H=ie(V,C))==null||H(f))}}),t}),de=_(()=>{var d;const t=(d=n.getComponentDefinition(s.value.type))==null?void 0:d.fields;if(!t)return;const o={};return Object.keys(t).forEach(i=>{t[i].applyStyleVariable&&e[i]&&(o[`--${i}`]=e[i].value)}),o}),ue=_(()=>{var h;const t="cssClasses",o=(h=n.getComponentDefinition(s.value.type))==null?void 0:h.fields;if(!o||!o[t]||!e[t])return;const d=e[t].value,i=d==null?void 0:d.split(" ").map(C=>C.trim()),v={};return i.forEach(C=>{v[C]=!0}),v}),pe=function(){return{class:{[`wf-type-${s.value.type}`]:!0,component:!0,childless:z.value,selected:N.value,disabled:E.value,beingEdited:p.value,...ue.value},style:{...de.value,...le.value?{}:{display:"none"}},...re,...E.value?[]:ce.value,draggable:A.value}},me=(t,o)=>p.value?T(De,{...t,componentType:s.value.type,message:o}):T("div");return()=>{const t=p.value?oe():void 0,o=({instanceNumber:i=0,slotName:v="default",componentFilter:h=()=>!0,positionlessSlot:C=!1})=>z.value?C?void 0:t:K(i,v,h,C),d={...pe()};return B(s.value.parentId,s.value.type)?T(y,d,{default:o}):me(d,"Parent is not suitable for this component")}}},ne=W(Fe,[["__scopeId","data-v-9f03bf9d"]]),R=a=>(ee("data-v-b2157300"),a=a(),te(),a),Ae=R(()=>c("i",{class:"icon material-symbols-outlined"}," notifications ",-1)),Ve={class:"counter"},ke=R(()=>c("div",{class:"balloonFlash"},null,-1)),Re={class:"main"},Le={class:"clearContainer"},Ne=R(()=>c("i",{class:"material-symbols-outlined"}," clear_all ",-1)),je=R(()=>c("i",{class:"material-symbols-outlined"}," exclamation ",-1)),We=[je],Ke={class:"content"},qe={class:"title"},ze={class:"time"},Oe={class:"message"},He=100,Ue=k({__name:"RendererNotifications",setup(a){const n=F(g.core),u=M(!1),l=M(null),s=ge([]),y=b=>{const{type:P,title:e,message:m,code:p}=b;s.unshift({type:P,title:e,message:m,code:p,timestampReceived:new Date}),s.splice(He),l.value.classList.remove("alert"),l.value.offsetWidth,l.value.classList.add("alert")};_e(()=>{n.addMailSubscription("notification",y)});const r=()=>{s.length!=0&&(u.value=!u.value)},S=()=>{s.splice(0),u.value=!1};return(b,P)=>U(($(),x("div",{class:"RendererNotifications colorTransformer",onClick:r},[c("div",{ref_key:"balloon",ref:l,class:"balloon",title:"Toggle notifications"},[Ae,c("div",Ve,w(s.length),1)],512),ke,U(c("div",Re,[c("div",Le,[J(Ce,{onClick:S},{default:he(()=>[Ne,ye(" Clear all ")]),_:1})]),($(!0),x(be,null,Ie(s,(e,m)=>($(),x("div",{key:m,class:"notification"},[c("div",{class:Q(["icon",e.type])},We,2),c("div",Ke,[c("header",null,[c("strong",qe,w(e.title),1),c("span",ze,w(e.timestampReceived.toLocaleTimeString()),1)]),c("div",Oe,w(e.message),1)])]))),128))],512),[[X,u.value]])],512)),[[X,s.length>0]])}}),Xe=W(Ue,[["__scopeId","data-v-b2157300"]]),Ye=a=>(ee("data-v-5905d96a"),a=a(),te(),a),Ge=Ye(()=>c("div",{class:"loadingBar"},null,-1)),Ze={class:"rootComponentArea"},Je=k({__name:"ComponentRenderer",setup(a){const n=F(g.core),u=Z(n),l=n.getComponentById("root");l||console.error("No root component found.");const s=[{componentId:"root",instanceNumber:0}],y=[M(null)],r=u.getEvaluatedFields(s),S=_(()=>{var e,m,p,A,B,E;return{"--accentColor":(e=r.accentColor)==null?void 0:e.value,"--emptinessColor":(m=r.emptinessColor)==null?void 0:m.value,"--containerBackgroundColor":(p=r.parentIdBackgroundColor)==null?void 0:p.value,"--primaryTextColor":(A=r.primaryTextColor)==null?void 0:A.value,"--secondaryTextColor":(B=r.secondaryTextColor)==null?void 0:B.value,"--separatorColor":(E=r.separatorColor)==null?void 0:E.value}}),b=_(()=>n.getFrontendMessageMap().size>0);j(()=>{var e;return(e=r.appName)==null?void 0:e.value},e=>{P(e)},{immediate:!0});function P(e){const m=n.getMode();let p;e&&m=="edit"?p=`${e} | Writer Framework | Builder`:!e&&m=="edit"?p="Writer Framework | Builder":e&&m=="run"?p=`${e}`:!e&&m=="run"&&(p="Writer Framework App"),document.title=p}return(e,m)=>($(),x("main",{class:Q(["ComponentRenderer",{loadingActive:b.value}]),tabindex:"-1",style:$e(S.value)},[J(Xe,{class:"notifications"}),Ge,c("div",Ze,[Y(l)?($(),G(ne,{key:0,"component-id":Y(l).id,"instance-path":s,"instance-data":y},null,8,["component-id"])):Se("",!0),Pe(e.$slots,"default",{},void 0,!0)])],6))}}),Qe=W(Je,[["__scopeId","data-v-5905d96a"]]),nt=Object.freeze(Object.defineProperty({__proto__:null,default:Qe},Symbol.toStringTag,{value:"Module"}));export{Qe as C,nt as a,tt as p};
