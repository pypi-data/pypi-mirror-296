System.register(["vue","./sentry-legacy.5.2.0.js","./_commonjsHelpers-legacy.5.2.0.js"],(function(e,r){"use strict";var a,l,t,o,n,i,s,d,u,c,f,m,b,v,p,g,_,h,y,w,k,z,A,x,C,M,q,R,B,S,V,T,E,P,U,I,O,$,D,H,N,j,L,W,Y,Z,J,F,K,Q,X,G,ee,re,ae,le,te,oe,ne,ie,se,de,ue,ce,fe,me,be;return{setters:[e=>{a=e.openBlock,l=e.createElementBlock,t=e.unref,o=e.createElementVNode,n=e.renderSlot,i=e.defineComponent,s=e.ref,d=e.onMounted,u=e.watchEffect,c=e.resolveComponent,f=e.createVNode,m=e.withCtx,b=e.createTextVNode,v=e.toDisplayString,p=e.createCommentVNode,g=e.normalizeClass,_=e.Fragment,h=e.renderList,y=e.createBlock,w=e.computed,k=e.Teleport,z=e.withModifiers,A=e.createApp},e=>{x=e.c,C=e.ak,M=e._,q=e.A,R=e.P,B=e.aJ,S=e.f,V=e.a,T=e.C,E=e.ag,P=e.aK,U=e.aL,I=e.d,O=e.I,$=e.a8,D=e.M,H=e.aM,N=e.W,j=e.aN,L=e.aO,W=e.aP,Y=e.aQ,Z=e.x,J=e.aR,F=e.aS,K=e.aT,Q=e.aU,X=e.aV,G=e.ap,ee=e.aW,re=e.aX,ae=e.av,le=e.aq,te=e.ay,oe=e.aj,ne=e.az,ie=e.aA,se=e.aB,de=e.V,ue=e.aY,ce=e.aZ,fe=e.aC,me=e.aD,be=e.aE},null],execute:function(){var e=document.createElement("style");e.textContent=".fr-sidemenu__link[data-v-6240fbee]{padding:.25rem .375rem}.fr-sidemenu__link[aria-current][data-v-6240fbee]:before{width:0}.fr-sidemenu__link[data-v-6240fbee]:has(>[aria-current]){border-radius:2px;background-color:var(--background-alt-grey);color:var(--text-default-grey);font-weight:800}.fr-sidemenu__link[data-v-6240fbee]:has(>[aria-current]):hover{background-color:var(--background-alt-grey-hover)}.fr-sidemenu__link[data-v-6240fbee]:has(>[aria-current]):active{background-color:var(--background-alt-grey-active)}.fr-sidemenu__btn[data-v-dc2a4e61]{background-color:var(--background-alt-grey);border-bottom:1px solid var(--border-default-grey)}.fr-sidemenu__btn[data-v-dc2a4e61]:hover{background-color:var(--background-alt-grey-hover)}.fr-sidemenu__btn[data-v-dc2a4e61]:active{background-color:var(--background-alt-grey-active)}.fr-sidemenu__btn[aria-current][data-v-dc2a4e61]{background-color:var(--background-default-grey);color:var(--text-default-grey)}.fr-sidemenu__btn[aria-current][data-v-dc2a4e61]:before{width:0}.fr-sidemenu__btn[aria-current][data-v-dc2a4e61]:hover{background-color:var(--hover-tint)}.fr-sidemenu__btn[aria-current][data-v-dc2a4e61]:active{background-color:var(--active-tint)}html,body{height:100%}#app{display:flex;flex-direction:column;height:100%}.fr-sidemenu .fr-sidemenu__item:first-child:before,.fr-sidemenu .fr-sidemenu__item:last-child:before,.fr-sidemenu .fr-sidemenu__item:before{box-shadow:none}.fr-sidemenu[data-v-7df981bd]{padding:0}.fr-sidemenu .fr-sidemenu__inner[data-v-7df981bd]{padding:0;box-shadow:1px 0 0 0 var(--border-default-grey);background-color:var(--grey-1000-50)}@media (min-width: 48em){.fr-sidemenu[data-v-7df981bd],.fr-sidemenu__inner[data-v-7df981bd]{height:100%}}\n",document.head.appendChild(e);const r=["aria-label"],ve={class:"fr-breadcrumb__list"},pe={__name:"Breadcrumb",setup(e){const{t:i}=x();return(e,s)=>(a(),l("nav",{rol:"navigation","aria-label":t(i)("You're here:"),class:"fr-breadcrumb fr-mb-5v"},[o("ol",ve,[n(e.$slots,"default")])],8,r))}},ge={class:"fr-container--fluid"},_e={key:0},he={class:"fr-breadcrumb__link","aria-current":"page"},ye={class:"fr-alert fr-alert--info"},we={class:"fr-alert__title"},ke=i({__name:"Datasets",props:{oid:{}},setup(e){const{t:r}=x(),n=e,i=`/admin/organization/${n.oid}/`,g=s(null),_=s(null);return d((async()=>g.value=await C())),u((()=>{var e,r;_.value=null!==(e=null===(r=g.value)||void 0===r?void 0:r.organizations.find((e=>e.id===n.oid)))&&void 0!==e?e:null})),(e,n)=>{const s=c("router-link");return a(),l("div",ge,[f(pe,null,{default:m((()=>[o("li",null,[f(s,{class:"fr-breadcrumb__link",to:"/"},{default:m((()=>[b(v(t(r)("Administration")),1)])),_:1})]),_.value?(a(),l("li",_e,[f(s,{class:"fr-breadcrumb__link",to:"/"},{default:m((()=>[b(v(_.value.name),1)])),_:1})])):p("",!0),o("li",null,[o("a",he,v(t(r)("Datasets")),1)])])),_:1}),o("div",ye,[o("h3",we,v(t(r)("This is a WIP page")),1),o("p",null,[o("a",{href:i},v(t(r)("You can manage your datasets on the current admin.")),1)])])])}}}),ze={class:"fr-container--fluid"},Ae={key:0},xe={class:"fr-breadcrumb__link","aria-current":"page"},Ce={class:"fr-alert fr-alert--info"},Me={class:"fr-alert__title"},qe=i({__name:"Reuses",props:{oid:{}},setup(e){const{t:r}=x(),n=e,i=`/admin/organization/${n.oid}/`,g=s(null),_=s(null);return d((async()=>g.value=await C())),u((()=>{var e,r;_.value=null!==(e=null===(r=g.value)||void 0===r?void 0:r.organizations.find((e=>e.id===n.oid)))&&void 0!==e?e:null})),(e,n)=>{const s=c("router-link");return a(),l("div",ze,[f(pe,null,{default:m((()=>[o("li",null,[f(s,{class:"fr-breadcrumb__link",to:"/"},{default:m((()=>[b(v(t(r)("Administration")),1)])),_:1})]),_.value?(a(),l("li",Ae,[f(s,{class:"fr-breadcrumb__link",to:"/"},{default:m((()=>[b(v(_.value.name),1)])),_:1})])):p("",!0),o("li",null,[o("a",xe,v(t(r)("Reuses")),1)])])),_:1}),o("div",Ce,[o("h3",Me,v(t(r)("This is a WIP page")),1),o("p",null,[o("a",{href:i},v(t(r)("You can manage your reuses on the current admin.")),1)])])])}}}),Re={class:"fr-container--fluid"},Be={class:"fr-breadcrumb__link","aria-current":"page"},Se={key:0,class:"fr-h1"},Ve={class:"fr-alert fr-alert--info"},Te={class:"fr-alert__title"},Ee={href:"/admin/me/"},Pe=i({__name:"Me",setup(e){const{t:r}=x(),n=s(null);return d((async()=>n.value=await C())),(e,i)=>{const s=c("router-link");return a(),l("div",Re,[f(pe,null,{default:m((()=>[o("li",null,[f(s,{class:"fr-breadcrumb__link",to:"/"},{default:m((()=>[b(v(t(r)("Administration")),1)])),_:1})]),o("li",null,[o("a",Be,v(t(r)("Me")),1)])])),_:1}),n.value?(a(),l("h1",Se,v(n.value.first_name)+" "+v(n.value.last_name),1)):p("",!0),o("div",Ve,[o("h3",Te,v(t(r)("This is a WIP page")),1),o("p",null,[o("a",Ee,v(t(r)("You can edit your profil on the current admin.")),1)])])])}}}),Ue={class:"fr-sidemenu__item"},Ie=["innerHTML"],Oe=M(i({__name:"AdminSidebarLink",props:{label:{},icon:{},iconHtml:{},to:{}},setup:e=>(e,r)=>{const t=c("router-link");return a(),l("li",Ue,[o("div",{class:g([{"fr-icon-svg fr-icon--sm":e.iconHtml},"fr-enlarge-link fr-sidemenu__link fr-mb-1w"])},[e.iconHtml?(a(),l("div",{key:0,class:"fr-mr-1w fr-grid-row",innerHTML:e.iconHtml},null,8,Ie)):e.icon?(a(),l("div",{key:1,class:g([e.icon,"fr-mr-1w fr-icon--sm"]),"aria-hidden":"true"},null,2)):p("",!0),f(t,{to:e.to},{default:m((()=>[b(v(e.label),1)])),_:1},8,["to"])],2)])}}),[["__scopeId","data-v-6240fbee"]]),$e=["aria-expanded","aria-controls","aria-current"],De={class:"logo logo--sm"},He={class:"fr-mx-1w fr-col text-overflow-ellipsis"},Ne=["id"],je={class:"fr-sidemenu__list fr-mx-1w fr-my-3v"},Le=i({__name:"AdminSidebarOrganizationMenu",props:{organization:{},isOpened:{type:Boolean}},setup(e){const{t:r}=x(),n=q("organization-menu");return(e,i)=>(a(),l("li",{class:g(["fr-sidemenu__item",{"fr-sidemenu__item--active":e.isOpened}])},[o("button",{class:"fr-sidemenu__btn","aria-expanded":e.isOpened,"aria-controls":t(n),"aria-current":e.isOpened},[o("div",De,[f(R,{type:"organization",src:e.organization.logo_thumbnail,size:20},null,8,["src"])]),o("p",He,v(e.organization.name),1)],8,$e),o("div",{class:"fr-collapse","data-fr-js-collapse":"",id:t(n)},[o("ul",je,[f(Oe,{iconHtml:t('<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M5 12V18C5 18 5 21 12 21C19 21 19 18 19 18V12" stroke="currentColor" stroke-width="1.5"/>\n<path d="M5 6V12C5 12 5 15 12 15C19 15 19 12 19 12V6" stroke="currentColor" stroke-width="1.5"/>\n<path d="M12 3C19 3 19 6 19 6C19 6 19 9 12 9C5 9 5 6 5 6C5 6 5 3 12 3Z" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'),label:t(r)("Datasets"),to:{name:"organization-datasets",params:{oid:e.organization.id}}},null,8,["iconHtml","label","to"]),f(Oe,{icon:"fr-icon-line-chart-line",label:t(r)("Reuses"),to:{name:"organization-reuses",params:{oid:e.organization.id}}},null,8,["label","to"]),f(Oe,{icon:"fr-icon-parent-line",label:t(r)("Members"),to:{name:"organization-members",params:{oid:e.organization.id}}},null,8,["label","to"]),f(Oe,{icon:"fr-icon-user-line",label:t(r)("Profile"),to:{name:"organization-profile",params:{oid:e.organization.id}}},null,8,["label","to"])])],8,Ne)],2))}}),We=M(Le,[["__scopeId","data-v-dc2a4e61"]]),Ye={class:"fr-container--fluid h-100"},Ze={class:"fr-grid-row h-100 bg-grey-50"},Je={class:"fr-col-12 fr-col-md-4 fr-col-lg-3 fr-col-xl-2"},Fe=["aria-label"],Ke={class:"fr-sidemenu__inner"},Qe=["aria-controls"],Xe=["id"],Ge={class:"fr-sidemenu__list"},er={class:"fr-sidemenu__item"},rr=["aria-controls"],ar={class:"fr-mx-1v"},lr=["id"],tr={class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-col-xl-10 h-100 fr-px-2w"},or=M(i({__name:"Admin",setup(e){const{t:r}=x(),n=B(),i=q("menu"),u=q("profil-submenu"),m=s(null),b=s(null);return d((async()=>{m.value=await C(),m.value.organizations.length>0&&(n.params.oid?b.value=n.params.oid:b.value=m.value.organizations[0].id)})),(e,s)=>{const d=c("router-view");return a(),l("div",Ye,[o("div",Ze,[o("div",Je,[o("nav",{class:"fr-sidemenu","aria-label":t(r)("Administration menu")},[o("div",Ke,[o("button",{class:"fr-sidemenu__btn",hidden:"","aria-controls":t(i),"aria-expanded":"false"},v(t(r)("Open menu")),9,Qe),o("div",{class:"fr-collapse",id:t(i)},[o("ul",Ge,[o("li",er,[o("button",{class:"fr-sidemenu__btn border-bottom border-default-grey","aria-expanded":"false","aria-controls":t(u)},[f(S,{user:t(V),size:24,rounded:!0},null,8,["user"]),o("p",ar,v(t(r)("My Profil")),1)],8,rr),o("div",{class:"fr-collapse",id:t(u)},[f(Oe,{icon:"fr-icon-account-circle-line",label:t(r)("Me"),to:"/me"},null,8,["label"])],8,lr)]),m.value?(a(!0),l(_,{key:0},h(m.value.organizations,(e=>{return a(),y(We,{organization:e,"is-opened":(r=e.id,r===b.value)},null,8,["organization","is-opened"]);var r})),256)):p("",!0)])],8,Xe)])],8,Fe)]),o("div",tr,[(a(),y(d,{key:t(n).fullPath}))])])])}}}),[["__scopeId","data-v-7df981bd"]]),nr={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},ir=i({__name:"AdminDangerZone",setup:e=>(e,r)=>(a(),y(t(T),{color:"error",type:"secondary",weight:"regular"},{default:m((()=>[o("div",nr,[n(e.$slots,"default")])])),_:3}))}),sr=["aria-labelledby","id"],dr={class:"fr-container fr-container--fluid fr-container-md"},ur={class:"fr-grid-row fr-grid-row--center"},cr={class:"fr-col-12 fr-col-md-8"},fr={class:"fr-modal__body"},mr={class:"fr-modal__header"},br=["title","aria-controls"],vr={class:"fr-modal__content"},pr=["id"],gr={class:"fr-grid-row fr-grid-row--middle fr-text--bold fr-mb-2w"},_r={class:"fr-col"},hr={class:"fr-col-auto"},yr=["disabled"],wr={class:"fr-col"},kr={class:"fr-m-0 text-grey-500"},zr={class:"fr-m-0 fr-text--xs text-default-error"},Ar={class:"fr-col-auto"},xr=["disabled"],Cr=i({__name:"AdminEditMemberModal",props:{id:{},member:{},oid:{},roles:{}},emits:["memberUpdated"],setup(e,{emit:r}){const l=e,n=r,i=w((()=>"fr-modal-title-user-"+l.id)),{t:d}=x(),{toast:u}=I(),c=s(!1);function g(){c.value=!1;const e=document.getElementById(l.id);globalThis.dsfr(e).modal.conceal()}return(e,r)=>{return a(),y(k,{to:"body"},[o("dialog",{"aria-labelledby":i.value,role:"dialog",id:e.id,class:"fr-modal"},[o("div",dr,[o("div",ur,[o("div",cr,[o("div",fr,[o("div",mr,[o("button",{class:"fr-btn--close fr-btn",title:t(d)("Close the modal dialog"),"aria-controls":e.id},v(t(d)("Close")),9,br)]),o("div",vr,[o("h1",{id:i.value,class:"fr-modal__title fr-mb-2w"},v(t(d)("Edit member")),9,pr),o("p",gr,[f(S,{class:"fr-mr-1v",user:e.member.user,rounded:!0,size:24},null,8,["user"]),b(" "+v(e.member.user.first_name)+" "+v(e.member.user.last_name),1)]),o("form",{class:"fr-grid-row fr-grid-row--gutters fr-grid-row--bottom",onSubmit:r[1]||(r[1]=z((r=>async function(e){if(e.newRole)try{c.value=!0,await P(l.oid,e.user.id,e.newRole),n("memberUpdated"),g()}catch(r){u.error(d("An error occurred while update member role."))}finally{c.value=!1}else g()}(e.member)),["prevent"]))},[o("div",_r,[e.roles.length>0?(a(),y(E,{key:0,label:t(d)("Role of the member"),"model-value":e.member.role,"onUpdate:modelValue":r[0]||(r[0]=r=>e.member.newRole=r),options:(s=e.member.role,l.roles.map((e=>{const r={...e};return r.value===s&&(r.selected=!0),r})))},null,8,["label","model-value","options"])):p("",!0)]),o("div",hr,[o("button",{class:"fr-btn",type:"submit",disabled:c.value},v(t(d)("Validate")),9,yr)])],32),f(ir,{class:"fr-mt-2w"},{default:m((()=>[o("div",wr,[o("p",kr,v(t(d)("Remove member from the organization")),1),o("p",zr,v(t(d)("Be careful, this action can't be reverse.")),1)]),o("div",Ar,[o("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error fr-btn--icon-left fr-icon-logout-box-r-line",disabled:c.value,onClick:r[2]||(r[2]=r=>async function(e){try{c.value=!0,await U(l.oid,e.user.id),n("memberUpdated")}catch(r){u.error(d("An error occurred while removing this member."))}finally{c.value=!1}}(e.member))},v(t(d)("Remove member")),9,xr)])])),_:1})])])])])])],8,sr)]);var s}}}),Mr=["aria-controls"],qr=i({__name:"AdminEditMemberButton",props:{member:{},oid:{},roles:{}},emits:["memberUpdated"],setup(e){const r=e,{t:n}=x(),i=w((()=>"fr-modal-user-"+r.member.user.id));return(e,r)=>(a(),l(_,null,[o("button",{class:"fr-btn fr-btn--sm fr-btn--tertiary-no-outline fr-icon-pencil-line","data-fr-opened":"false","aria-controls":i.value},v(t(n)("Edit")),9,Mr),f(Cr,{id:i.value,member:e.member,oid:e.oid,roles:e.roles,onMemberUpdated:r[0]||(r[0]=r=>e.$emit("memberUpdated"))},null,8,["id","member","oid","roles"])],64))}}),Rr={class:"fr-mt-n9v fr-mb-2w"},Br={class:"fr-badge fr-badge--info fr-badge--no-icon"},Sr={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},Vr={class:"fr-col"},Tr={class:"fr-grid-row fr-grid-row--middle"},Er={class:"fr-ml-3v fr-mt-1-5v fr-mb-0 filet filet-default-grey fr-text--sm"},Pr={key:0,class:"fr-col-auto fr-grid-row flex-direction-column"},Ur=["disabled"],Ir=["disabled","aria-controls"],Or=["aria-labelledby","id"],$r={class:"fr-container fr-container--fluid fr-container-md"},Dr={class:"fr-grid-row fr-grid-row--center"},Hr={class:"fr-col-12 fr-col-md-8"},Nr={class:"fr-modal__body"},jr={class:"fr-modal__header"},Lr=["title","aria-controls"],Wr={class:"fr-modal__content"},Yr=["id"],Zr={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--right"},Jr={class:"fr-col-auto"},Fr=["disabled"],Kr={class:"fr-col-auto"},Qr=["disabled"],Xr=i({__name:"AdminMembershipRequest",props:{loading:{type:Boolean},oid:{},request:{},showActions:{type:Boolean}},emits:["accept","refuse"],setup(e,{emit:r}){const n=e,i=r,{t:d}=x(),u=s(""),g=q("modal"),_=q("modalTitle");function h(){const e=document.getElementById(g);globalThis.dsfr(e).modal.conceal()}function w(){i("refuse",n.request.id,u.value),h()}function A(){u.value="",h()}return(e,r)=>{const n=c("AdminMembershipRequest",!0);return a(),y(O,{class:"drop-shadow rounded-xxs fr-mt-3w"},{default:m((()=>[o("div",Rr,[o("p",Br,[r[2]||(r[2]=o("span",{class:"fr-icon-user-add-line fr-icon--sm","aria-hidden":"true"},null,-1)),b(" "+v(t(d)("Membership Request")),1)])]),o("div",Sr,[o("div",Vr,[o("div",Tr,[f(S,{class:"fr-mr-1v",user:e.request.user,rounded:!0,size:24},null,8,["user"]),b(" "+v(t(d)("{fullName} asks to join the organization.",{fullName:e.request.user.first_name+" "+e.request.user.last_name})),1)]),o("div",Er,v(e.request.comment),1)]),e.showActions?(a(),l("div",Pr,[o("button",{class:"fr-btn fr-btn--sm fr-btn--icon-left fr-mb-1w fr-icon-check-line",onClick:r[0]||(r[0]=r=>e.$emit("accept",e.request.id)),disabled:e.loading,"data-testid":"accept"},v(t(d)("Accept request")),9,Ur),o("button",{class:"fr-btn fr-btn--icon-left fr-btn--sm fr-btn--secondary fr-btn--secondary--error fr-icon-close-line",disabled:e.loading,"data-fr-opened":"false","aria-controls":t(g),"data-testid":"refuse"},v(t(d)("Refuse")),9,Ir),(a(),y(k,{to:"body"},[o("dialog",{"aria-labelledby":t(_),role:"dialog",id:t(g),class:"fr-modal","data-testid":"modal"},[o("div",$r,[o("div",Dr,[o("div",Hr,[o("div",Nr,[o("div",jr,[o("button",{class:"fr-btn--close fr-btn",title:t(d)("Close the modal dialog"),"aria-controls":t(g),onClick:z(A,["prevent"])},v(t(d)("Close")),9,Lr)]),o("div",Wr,[o("h1",{id:t(_),class:"fr-modal__title fr-mb-2w"},v(t(d)("Refuse membership request")),9,Yr),f(n,{class:"fr-mt-4w fr-mb-2w",loading:!1,oid:e.oid,request:e.request,"show-actions":!1},null,8,["oid","request"]),o("form",{onSubmit:z(w,["prevent"]),onReset:A},[f($,{label:t(d)("You can provide the refusal reason:"),modelValue:u.value,"onUpdate:modelValue":r[1]||(r[1]=e=>u.value=e),"data-testid":"comment-group"},null,8,["label","modelValue"]),o("div",Zr,[o("div",Jr,[o("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",type:"reset",disabled:e.loading,"data-testid":"cancel-modal-button"},v(t(d)("Cancel")),9,Fr)]),o("div",Kr,[o("button",{class:"fr-btn",type:"submit",disabled:e.loading,"data-testid":"refuse-modal-button"},v(t(d)("Refuse request")),9,Qr)])])],32)])])])])])],8,Or)]))])):p("",!0)])])),_:1})}}}),Gr=["aria-labelledby","id"],ea={class:"fr-container fr-container--fluid fr-container-md"},ra={class:"fr-grid-row fr-grid-row--center"},aa={class:"fr-col-12 fr-col-md-8"},la={class:"fr-modal__body"},ta={class:"fr-modal__header"},oa=["title","aria-controls"],na={class:"fr-modal__content"},ia=["id"],sa={class:"fr-modal__footer"},da={class:"fr-btns-group fr-btns-group--right fr-btns-group--sm fr-btns-group--inline-lg fr-btns-group--icon-left"},ua=["disabled"],ca=["disabled"],fa=i({__name:"AdminAddMemberModal",props:{id:{},oid:{},roles:{}},emits:["memberAdded"],setup(e,{emit:r}){const l=e,n=r,{t:i}=x(),{toast:d}=I(),u=s(!1),c=s(),m=s("editor"),b=w((()=>"fr-modal-title-user-"+l.id));async function g(){try{u.value=!0,c.value&&(await H(l.oid,c.value,m.value),n("memberAdded"),h())}catch(e){d.error(i("An error occurred while update member role."))}finally{u.value=!1}}function _(e){return e.map((e=>{var r;const a={...e,avatar_thumbnail:null!==(r=e.avatar_url)&&void 0!==r?r:void 0};return{value:a.id,label:a.first_name+" "+a.last_name,image:N(a,32)}}))}function h(){u.value=!1,c.value=void 0,m.value="editor";const e=document.getElementById(l.id);globalThis.dsfr(e).modal.conceal()}return(e,r)=>(a(),y(k,{to:"body"},[o("dialog",{"aria-labelledby":b.value,role:"dialog",id:e.id,class:"fr-modal"},[o("div",ea,[o("div",ra,[o("div",aa,[o("div",la,[o("div",ta,[o("button",{class:"fr-btn--close fr-btn",title:t(i)("Close the modal dialog"),"aria-controls":e.id},v(t(i)("Close")),9,oa)]),o("form",{onSubmit:z(g,["prevent"])},[o("div",na,[o("h1",{id:b.value,class:"fr-modal__title fr-mb-2w"},v(t(i)("Add member to the organization")),9,ia),f(D,{placeholder:e.$t("Search a user"),searchPlaceholder:e.$t("Search a user..."),suggestUrl:"/users/suggest/",values:c.value,onChange:r[0]||(r[0]=e=>c.value=e),allOption:e.$t("Select a user"),addAllOption:!1,onSuggest:_,roundedImages:!0},null,8,["placeholder","searchPlaceholder","values","allOption"]),e.roles.length>0?(a(),y(E,{key:0,label:t(i)("Role of the member"),"model-value":m.value,"onUpdate:modelValue":r[1]||(r[1]=e=>m.value=e),options:e.roles},null,8,["label","model-value","options"])):p("",!0)]),o("div",sa,[o("div",da,[o("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",type:"button",onClick:h,disabled:u.value},v(t(i)("Cancel")),9,ua),o("button",{class:"fr-btn",type:"submit",disabled:u.value},v(t(i)("Add to the organization")),9,ca)])])],32)])])])])],8,Gr)]))}}),ma=["aria-controls"],ba=i({__name:"AdminAddMemberButton",props:{oid:{},roles:{}},emits:["memberAdded"],setup(e){const r=e,{t:n}=x(),i=w((()=>"fr-modal-add-user-"+r.oid));return(e,r)=>(a(),l(_,null,[o("button",{class:"fr-btn fr-btn--sm fr-btn--icon-left fr-icon-add-line","data-fr-opened":"false","aria-controls":i.value},v(t(n)("Add member")),9,ma),f(fa,{id:i.value,oid:e.oid,roles:e.roles,onMemberAdded:r[0]||(r[0]=r=>e.$emit("memberAdded"))},null,8,["id","oid","roles"])],64))}}),va={key:0},pa={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-center"},ga={class:"fr-col-12 fr-col-md"},_a={class:"fr-h1 fr-mb-2w"},ha={key:0,class:"fr-col-auto"},ya={class:"subtitle subtitle--uppercase"},wa={class:"subtitle subtitle--uppercase fr-mt-2w fr-mb-1v"},ka={class:"fr-table fr-table--layout-fixed"},za={scope:"col"},Aa={scope:"col"},xa={scope:"col"},Ca={scope:"col"},Ma={scope:"col"},qa={key:0,scope:"col"},Ra={class:"fr-badge"},Ba={key:0},Sa={key:1},Va={key:0},Ta=i({__name:"Members",props:{oid:{}},setup(e){const r=e,{t:n}=x(),{toast:i}=I(),g=s([]),k=w((()=>j||C.value.some((e=>{var r;return e.user.id===(null===(r=V)||void 0===r?void 0:r.id)&&"admin"===e.role})))),z=s([]),A={name:"SomeName"},C=s([]),M=s(!1);async function q(){const e=await F(r.oid);C.value=e.members}async function R(){const e=await L(r.oid);g.value=e}async function B(e){M.value=!0;const a=[];try{await K(r.oid,e),a.push(R()),a.push(q())}catch(l){i.error(n("An error occurred while accepting this membership."))}finally{Promise.all(a).finally((()=>M.value=!1))}}async function S(e,a){M.value=!0;const l=[];try{await Q(r.oid,e,a),l.push(R()),l.push(q())}catch(t){i.error(n("An error occurred while refusing this membership."))}finally{Promise.all(l).finally((()=>M.value=!1))}}return u((()=>{k.value&&L(r.oid).then((e=>g.value=e))})),d((()=>{W().then(Y).then((e=>z.value=e)),q()})),(e,r)=>{const i=c("router-link");return a(),l("div",null,[f(pe,null,{default:m((()=>[o("li",null,[f(i,{class:"fr-breadcrumb__link",to:"/"},{default:m((()=>[b(v(t(n)("Administration")),1)])),_:1})]),A?(a(),l("li",va,[f(i,{class:"fr-breadcrumb__link",to:"/"},{default:m((()=>[b(v(A.name),1)])),_:1})])):p("",!0),r[0]||(r[0]=o("li",null,null,-1))])),_:1}),o("div",pa,[o("div",ga,[o("h1",_a,v(t(n)("Members")),1)]),k.value?(a(),l("div",ha,[f(ba,{oid:e.oid,roles:z.value,onMemberAdded:q},null,8,["oid","roles"])])):p("",!0)]),g.value.length?(a(),l(_,{key:0},[o("h2",ya,v(t(n)("{n} requests",{n:g.value.length})),1),(a(!0),l(_,null,h(g.value,(r=>(a(),y(Xr,{class:"fr-mb-4w",key:r.id,loading:M.value,oid:e.oid,request:r,"show-actions":!0,onAccept:B,onRefuse:S},null,8,["loading","oid","request"])))),128))],64)):p("",!0),o("h2",wa,v(t(n)("{n} members",{n:C.value.length})),1),o("div",ka,[o("table",null,[o("thead",null,[o("tr",null,[o("th",za,v(t(n)("Members")),1),o("th",Aa,v(t(n)("Email")),1),o("th",xa,v(t(n)("Status")),1),o("th",Ca,v(t(n)("Member since")),1),o("th",Ma,v(t(n)("Last connection")),1),k.value?(a(),l("th",qa,v(t(n)("Action")),1)):p("",!0)])]),o("tbody",null,[(a(!0),l(_,null,h(C.value,(r=>{return a(),l("tr",{key:r.user.id},[o("td",null,v(r.user.first_name)+" "+v(r.user.last_name),1),o("td",null,v(r.user.email),1),o("td",null,[o("p",Ra,v((i=r.role,null!==(s=null===(d=z.value.find((e=>e.value===i)))||void 0===d?void 0:d.label)&&void 0!==s?s:i)),1)]),o("td",null,v(t(Z)(r.since)),1),o("td",null,[r.user.last_login_at?(a(),l("span",Ba,v(t(J)(r.user.last_login_at)),1)):(a(),l("span",Sa,v(t(n)("No connection")),1))]),k.value?(a(),l("td",Va,[f(qr,{member:r,oid:e.oid,roles:z.value,onMemberUpdated:q},null,8,["member","oid","roles"])])):p("",!0)]);var i,s,d})),128))])])])])}}}),Ea={class:"fr-container--fluid"},Pa={key:0},Ua={class:"fr-breadcrumb__link","aria-current":"page"},Ia=["id"],Oa=["disabled","onClick"],$a={class:"fr-col"},Da={class:"fr-m-0 text-grey-500"},Ha={class:"fr-m-0 fr-text--xs text-default-error"},Na={class:"fr-col-auto"},ja=["disabled","aria-controls"],La=["aria-labelledby","id"],Wa={class:"fr-container fr-container--fluid fr-container-md"},Ya={class:"fr-grid-row fr-grid-row--center"},Za={class:"fr-col-12 fr-col-md-8"},Ja={class:"fr-modal__body"},Fa={class:"fr-modal__header"},Ka=["title","aria-controls"],Qa={class:"fr-modal__content"},Xa=["id"],Ga={class:"fr-text--bold"},el={class:"fr-modal__footer"},rl={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},al=["disabled"],ll=i({__name:"Profile",props:{oid:{}},setup(e){const{t:r}=x(),{toast:n}=I(),i=e,g=X(),_=s(null),h=s(null),w=s(null),z=s([]),A=s(!1),M=q("modal"),R=q("modalTitle");function B(){w.value&&(A.value=!0,ee(w.value.id).then((()=>{g.replace("/"),window.location.reload()})).catch((()=>n.error(r("An error occured when deleting the organization.")))).finally((()=>A.value=!1)))}function S(e,a){A.value=!0,re(e).then((()=>n.success(r("Organization updated !")))).catch((()=>n.error(r("An error occured when updating the organization.")))).finally((()=>A.value=!1))}return d((async()=>_.value=await C())),u((async()=>{w.value=await F(i.oid)})),(e,n)=>{const i=c("router-link");return a(),l("div",Ea,[f(pe,null,{default:m((()=>[o("li",null,[f(i,{class:"fr-breadcrumb__link",to:"/"},{default:m((()=>[b(v(t(r)("Administration")),1)])),_:1})]),w.value?(a(),l("li",Pa,[f(i,{class:"fr-breadcrumb__link",to:"/"},{default:m((()=>[b(v(w.value.name),1)])),_:1})])):p("",!0),o("li",null,[o("a",Ua,v(t(r)("Profile")),1)])])),_:1}),h.value?(a(),l("h2",{key:0,class:"subtitle subtitle--uppercase fr-mb-5v",id:h.value.legend},v(t(r)("Edit profile")),9,Ia)):p("",!0),w.value?(a(),y(G,{key:1,organization:w.value,errors:z.value,showLegend:!1,showWell:!1,ref_key:"form",ref:h,onSubmit:S},{submitButton:m((({submit:e})=>[o("button",{class:"fr-btn fr-btn--icon-left fr-icon-save-line",disabled:A.value,"data-testid":"submitButton",onClick:e},v(t(r)("Save")),9,Oa)])),default:m((()=>[f(ir,{class:"fr-mt-6w"},{default:m((()=>[o("div",$a,[o("p",Da,v(t(r)("Delete the organization")),1),o("p",Ha,v(t(r)("Be careful, this action can't be reverse.")),1)]),o("div",Na,[o("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error fr-btn--icon-left fr-icon-delete-line",disabled:A.value,"data-fr-opened":"false","aria-controls":t(M)},v(t(r)("Delete")),9,ja),(a(),y(k,{to:"body"},[o("dialog",{"aria-labelledby":t(R),role:"dialog",id:t(M),class:"fr-modal"},[o("div",Wa,[o("div",Ya,[o("div",Za,[o("div",Ja,[o("div",Fa,[o("button",{class:"fr-btn--close fr-btn",title:t(r)("Close the modal dialog"),"aria-controls":t(M)},v(t(r)("Close")),9,Ka)]),o("div",Qa,[o("h1",{id:t(R),class:"fr-modal__title fr-mb-2w"},v(t(r)("Are you sure you want to delete this organization ?")),9,Xa),o("p",Ga,v(t(r)("This action can't be reverse.")),1),o("p",null,v(t(r)("All content published with this organization will stay online, with the same URL but in an anonymous form, i.e. without being linked to a data producer.")),1),o("p",null,v(t(r)("If you want to delete your published content too, start by deleting the contents before deleting your account.")),1)]),o("div",el,[o("div",rl,[o("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error",role:"button",disabled:A.value,onClick:B},v(t(r)("Delete")),9,al)])])])])])])],8,La)]))])])),_:1})])),_:1},8,["organization","errors"])):p("",!0)])}}});ae({admin_root:le,default_lang:te.global.locale.value,only_locales:te.global.locale.value,schema_documentation_url:oe,schema_validata_url:ne,show_copy_resource_permalink:!0,tabular_api_url:ie,tabular_page_size:se,title:de});const tl=[{path:"/me",component:Pe},{path:"/organizations/:oid",children:[{path:"datasets",component:ke,props:!0,name:"organization-datasets"},{path:"reuses",component:qe,props:!0,name:"organization-reuses"},{path:"members",component:Ta,props:!0,name:"organization-members"},{path:"profile",component:ll,props:!0,name:"organization-profile"}]}],ol=ue({history:ce(),routes:tl}),nl=A(or);fe(nl),nl.use(me),nl.use(be),nl.use(te),nl.use(ol),nl.mount("#admin"),globalThis.dsfr.start(),console.log("JS is injected !")}}}));
