
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/plot_scatterer_distribution.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_plot_scatterer_distribution.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_plot_scatterer_distribution.py:


Flow Cytometry Simulation and 2D Density Plot of Scattering Intensities
=======================================================================

This example demonstrates how to simulate a flow cytometer using the FlowCyPy library, analyze the pulse
signals from two detectors, and plot a 2D density plot of the scattering intensities.

Flow cytometry is a technique used to analyze the physical and chemical properties of particles as they flow
through a laser beam. This script simulates the behavior of particles in a flow, models the light scattering
detected by two detectors, and visualizes the scattering intensity data in a 2D hexbin plot.

Steps in the Script:
--------------------
1. Define the flow parameters (e.g., speed, area, scatterer density).
2. Create a particle size distribution.
3. Set up a laser source and detectors.
4. Simulate the flow cytometry experiment.
5. Analyze the pulse signals from both detectors.
6. Plot a 2D density plot of the scattering intensities from the two detectors.

.. GENERATED FROM PYTHON SOURCE LINES 21-65

.. code-block:: python3


    # Import necessary libraries and modules
    from FlowCyPy import FlowCytometer, ScattererDistribution, Analyzer, Detector, Source, FlowCell, Plotter
    from FlowCyPy.distribution import NormalDistribution
    from FlowCyPy.peak_detector import MovingAveragePeakDetector
    import numpy as np

    # Set random seed for reproducibility
    np.random.seed(20)

    # Step 1: Define the Flow Parameters
    flow = FlowCell(
        flow_speed=8e-6,           # Flow speed: 8 micrometers per second
        flow_area=1e-6,            # Flow area: 1 square micrometer
        total_time=8.0,            # Total simulation time: 8 seconds
        scatterer_density=1e13     # Particle density: 1e12 particles per cubic meter
    )

    # Step 2: Define Particle Size Distributions (Two Normal Distributions)
    size_distribution_0 = NormalDistribution(
        scale_factor=10,
        mean=3e-6,                 # Mean particle size: 3 micrometers
        std_dev=0.5e-6             # Standard deviation of particle size: 0.5 micrometer
    )

    size_distribution_1 = NormalDistribution(
        scale_factor=1,
        mean=30e-6,                # Mean particle size: 30 micrometers
        std_dev=3e-6               # Standard deviation of particle size: 1 micrometer
    )

    refractive_index_distribution = NormalDistribution(
        scale_factor=1,
        mean=1.5,
        std_dev=0.1
    )

    scatterer_distribution = ScattererDistribution(
        flow=flow,
        refractive_index=[refractive_index_distribution],      # Refractive index of the particles
        size=[size_distribution_0, size_distribution_1]  # List of distributions for different scatterer populations
    )









.. GENERATED FROM PYTHON SOURCE LINES 66-68

.. code-block:: python3

    scatterer_distribution.plot()

    scatterer_distribution.print_properties()


.. image-sg:: /gallery/images/sphx_glr_plot_scatterer_distribution_001.png
   :alt: 2D Density Plot of scatterer properties
   :srcset: /gallery/images/sphx_glr_plot_scatterer_distribution_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Flow Properties

    Flow Properties
    +-----------------------+-----------------------+
    | Property              | Value                 |
    +=======================+=======================+
    | Flow Speed            | 8.00 µm/s             |
    +-----------------------+-----------------------+
    | Flow Area             | 1.00 mm²              |
    +-----------------------+-----------------------+
    | Total Simulation Time | 8.00 s                |
    +-----------------------+-----------------------+
    | Scatterer Density     | 1.00×10¹ Tparticle/m³ |
    +-----------------------+-----------------------+
    | Number of events      | 6.03×10² particle     |
    +-----------------------+-----------------------+

    Scatterer Properties
    +-----------------------+----------------------------+
    | Property              | Value                      |
    +=======================+============================+
    | Mean Refractive Index | 1.49 refractive_index_unit |
    +-----------------------+----------------------------+
    | Mean Size             | 1.61×10¹ µm                |
    +-----------------------+----------------------------+
    | Number of Events      | 603                        |
    +-----------------------+----------------------------+
    | Coupling Factor       | mie                        |
    +-----------------------+----------------------------+





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.412 seconds)


.. _sphx_glr_download_gallery_plot_scatterer_distribution.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_scatterer_distribution.py <plot_scatterer_distribution.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_scatterer_distribution.ipynb <plot_scatterer_distribution.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
