"use strict";(self.webpackChunkjupyterlab_nbqueue=self.webpackChunkjupyterlab_nbqueue||[]).push([[400],{4400:(e,t,n)=>{n.r(t),n.d(t,{ButtonExtension:()=>q,default:()=>M});var o=n(7313),a=n(6241),l=n(7460),r=n(2200),i=n(3345),c=n.n(i),s=n(5665),u=n(1473),d=n(7354);async function m(e="",t={}){const n=d.ServerConnection.makeSettings(),o=u.URLExt.join(n.baseUrl,"jupyterlab-nbqueue",e);let a;try{a=await d.ServerConnection.makeRequest(o,t,n)}catch(e){throw new d.ServerConnection.NetworkError(e)}let l=await a.text();if(l.length>0)try{l=JSON.parse(l)}catch(e){console.log("Not a JSON response body.",a)}if(!a.ok)throw new d.ServerConnection.ResponseError(a,l.message||l);return l}const g=e=>{const[t,n]=c().useState(!0),[o]=c().useState(e.file),[a]=c().useState(e.bucket),[l]=c().useState(!0),[i]=c().useState("md"),u=()=>{n(!1)};return c().createElement(c().Fragment,null,c().createElement(s.Dialog,{open:t,onClose:u,fullWidth:l,maxWidth:i,PaperProps:{component:"form",onSubmit:async e=>{e.preventDefault();const t=new FormData(e.currentTarget),n=Object.fromEntries(t.entries());console.log(n),r.Notification.promise(m("workflow",{method:"POST",body:JSON.stringify({file:o,cpu:n["cpu-number"],ram:n["ram-number"],bucket:a,conda:n["conda-environment"],container:n["container-image"]})}),{pending:{message:"Sending files to AWS",options:{autoClose:3e3}},success:{message:(e,t)=>"Files sent successfully",options:{autoClose:3e3}},error:{message:(e,t)=>`Error sending files. Reason: ${e}`,options:{autoClose:3e3}}}),u()}}},c().createElement(s.DialogTitle,null,"Parameters"),c().createElement(s.DialogContent,null,c().createElement(s.DialogContentText,null,"Please fill the form with your parameters."),c().createElement(s.TextField,{required:!0,id:"cpu-number",name:"cpu-number",defaultValue:"1",label:"CPU",variant:"standard",margin:"dense",fullWidth:!0,autoFocus:!0}),c().createElement(s.TextField,{required:!0,id:"ram-number",name:"ram-number",defaultValue:"4",label:"RAM",variant:"standard",margin:"dense",fullWidth:!0}),c().createElement(s.TextField,{id:"container-image",name:"container-image",label:"Container Image",variant:"standard",margin:"dense",fullWidth:!0}),c().createElement(s.TextField,{id:"conda-environment",name:"conda-environment",label:"Conda environment",variant:"standard",margin:"dense",fullWidth:!0})),c().createElement(s.DialogActions,null,c().createElement(s.Button,{onClick:u},"Cancel"),c().createElement(s.Button,{type:"submit"},"Send"))))};c().createElement(s.CssBaseline,null);class p extends r.ReactWidget{constructor(e,t){super(),this.file=e,this.bucket=t}render(){return c().createElement("div",{style:{width:"400px",minWidth:"400px",display:"flex",flexDirection:"column",background:"var(--jp-layout-color1)"}},c().createElement(g,{file:this.file,bucket:this.bucket}))}}var f=n(5256),b=n(9012),h=n(2702),E=n(5273),w=n(1447),v=n(8738),y=n(5673),k=n(7034),S=n(9781),x=n(1225);const C=c().forwardRef((function(e,t){return c().createElement(s.Slide,{direction:"up",ref:t,...e})})),A=e=>{const[t]=c().useState(e.bucket),[n]=c().useState(!0),[o,a]=c().useState([]),[l,r]=c().useState(""),[i,u]=c().useState("paper"),[d,g]=c().useState(!1),[p,f]=c().useState("");function b({status:e}){switch(console.log(e),e){case"Succeeded":return c().createElement(E.A,null);case"Running":return c().createElement(v.A,null);case"Failed":return c().createElement(w.A,null)}}const A=async()=>{const e=await m("workflows?bucket="+t,{method:"GET"});console.log(e),a(e)},I=(e,t,n)=>async()=>{try{const e=await(async(e,t)=>{const n=await m("workflow?workflow_name="+e+"&bucket="+t,{method:"GET"});return console.log(n),n})(t,n);console.log(`Endpoint Workflow log Result => ${e}`),f(e),r(t)}catch(e){console.log(`Error => ${JSON.stringify(e,null,2)}`)}console.log(`Workflow Name => ${t}`),g(!0),u(e)},j=(e,t,n)=>async()=>{try{console.log("handleDownloadClick");const e=await(async(e,t)=>{const n=await m("workflow/download?workflow_name="+e+"&bucket="+t,{method:"GET"});return console.log(n),n})(t,n);console.log(`Endpoint Workflow log Result => ${e}`)}catch(e){console.log(`Error => ${JSON.stringify(e,null,2)}`)}console.log(`Workflow Name => ${t}`)},B=(e,t,n)=>async()=>{try{console.log("handleDeleteClick");const e=await(async(e,t)=>{const n=await m("workflow?workflow_name="+e+"&bucket="+t,{method:"DELETE"});return console.log(n),n})(t,n);console.log(`Endpoint Workflow log Result => ${e}`)}catch(e){console.log(`Error => ${JSON.stringify(e,null,2)}`)}console.log(`Workflow Name => ${t}`),A()},D=()=>{g(!1)},T=c().useRef(null);return c().useEffect((()=>{if(d){const{current:e}=T;null!==e&&e.focus()}}),[d]),c().useEffect((()=>{A(),console.log(o)}),[]),c().createElement(c().Fragment,null,c().createElement(s.AppBar,null,c().createElement(s.Toolbar,null,c().createElement(s.Typography,{variant:"h6",component:"div",sx:{flexGrow:1}},"NBQueue job list"),c().createElement(s.IconButton,{"aria-label":"delete",onClick:e=>{A()},color:"inherit"},c().createElement(h.A,null)))),c().createElement(s.Toolbar,null),c().createElement(s.Container,{sx:{height:"100%",overflowY:"auto",paddingBottom:5}},c().createElement(s.Grid,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"flex-start",rowSpacing:1,columnSpacing:{xs:1,sm:2,md:3}},c().createElement(s.Grid,{item:!0,xs:12},c().createElement("nav",{"aria-label":"execution job list"},c().createElement(s.List,{dense:n},o.map((e=>c().createElement(s.ListItem,null,c().createElement(s.ListItemAvatar,null,c().createElement(s.Avatar,{color:e.status},c().createElement(b,{status:e.status}))),c().createElement(s.ListItemText,{primary:e.name.split("/")[2],secondary:c().createElement(c().Fragment,null,c().createElement(s.Typography,{sx:{display:"inline"},component:"span",variant:"body2",color:"text.primary"},e.name.split("/")[3]),"—"+e.status)}),c().createElement(s.ListItemSecondaryAction,null,c().createElement(s.IconButton,{edge:"end","aria-label":"view logs",id:e.name,itemID:e.name,onClick:I("paper",e.name,t)},c().createElement(y.A,null)),c().createElement(s.IconButton,{edge:"end","aria-label":"view logs",id:e.name,itemID:e.name,onClick:j(0,e.name,t)},c().createElement(x.A,null)),c().createElement(s.IconButton,{edge:"end","aria-label":"view logs",id:e.name,itemID:e.name,onClick:B(0,e.name,t)},c().createElement(k.A,null)))))),c().createElement(s.ListItem,null,c().createElement(s.ListItemText,null))))))),c().createElement(s.Dialog,{fullScreen:!0,open:d,onClose:D,TransitionComponent:C},c().createElement(s.AppBar,{sx:{position:"relative"}},c().createElement(s.Toolbar,null,c().createElement(s.IconButton,{edge:"start",color:"inherit",onClick:D,"aria-label":"close"},c().createElement(S.A,null)),c().createElement(s.Typography,{sx:{ml:2,flex:1},variant:"h6",component:"div"},"LOGS"))),c().createElement(s.DialogTitle,{id:"scroll-dialog-title"},l),c().createElement(s.DialogContent,{dividers:"paper"===i},c().createElement(s.DialogContentText,{id:"scroll-dialog-description",ref:T,tabIndex:-1},c().createElement(s.Typography,{variant:"caption",display:"block",gutterBottom:!0,style:{whiteSpace:"pre-wrap",fontFamily:"monospace"}},p)))))};c().createElement(s.CssBaseline,null);class I extends r.ReactWidget{constructor(e){super(),this.bucket=e}render(){return c().createElement(A,{bucket:this.bucket})}}var j=n(4614);function B(e){let t=e.get("s3BucketId").composite;return console.log(`Atlas ID Loading Settings = ${t}`),t}var D=n(1079),T=n.n(D);const N="jupyterlab-nbqueue:plugin",W={id:"jupyterlab-nbqueue:plugin",description:"A JupyterLab extension for queuing notebooks executions.",autoStart:!0,requires:[o.IFileBrowserFactory,r.ICommandPalette,a.IMainMenu,j.ISettingRegistry],activate:async(e,t,n,o,a)=>{console.log("JupyterLab extension jupyterlab-nbqueue is activated!");const i=e.serviceManager.user;i.ready.then((()=>{console.debug("Identity:",i.identity),console.debug("Permissions:",i.permissions)}));let c="";if(await Promise.all([a.load(N)]).then((([e])=>{c=B(e)})).catch((e=>{console.error(`Something went wrong when getting the current atlas id.\n${e}`)})),T().isEqual(c,""))return void r.Notification.warning("S3 Bucket is not configured");const s=new I(c),u=new r.MainAreaWidget({content:s});u.toolbar.hide(),u.title.icon=l.runIcon,u.title.caption="NBQueue job list",e.shell.add(u,"right",{rank:501}),e.commands.addCommand("jupyterlab-nbqueue:open",{label:"NBQueue: Send to queue",caption:"Example context menu button for file browser's items.",icon:l.runIcon,execute:async()=>{var e;if(await Promise.all([a.load(N)]).then((([e])=>{c=B(e)})).catch((e=>{console.error(`Something went wrong when getting the current atlas id.\n${e}`)})),T().isEqual(c,""))return void r.Notification.warning("S3 Bucket is not configured");const n=null===(e=t.tracker.currentWidget)||void 0===e?void 0:e.selectedItems().next().value;if(n){const e=new p(n,c);e.title.label="NBQueue metadata",f.Widget.attach(e,document.body)}}}),e.contextMenu.addItem({command:"jupyterlab-nbqueue:open",selector:'.jp-DirListing-item[data-file-type="notebook"]',rank:0}),e.docRegistry.addWidgetExtension("Notebook",new q(a))}};class q{constructor(e){this.settings=e}createNew(e,t){const n=new r.ToolbarButton({className:"nbqueue-submit",label:"NBQueue: Send to queue",onClick:async()=>{let e="";if(await Promise.all([this.settings.load(N)]).then((([t])=>{e=B(t),console.log(e)})).catch((e=>{console.error(`Something went wrong when getting the current atlas id.\n${e}`)})),T().isEqual(e,""))return void r.Notification.warning("S3 Bucket is not configured");const n=new p(t.contentsModel,e);n.title.label="NBQueue metadata",f.Widget.attach(n,document.body)},tooltip:"Send notebook to execution queue"});return e.toolbar.insertItem(10,"clearOutputs",n),new b.DisposableDelegate((()=>{n.dispose()}))}}const M=W},9781:(e,t,n)=>{var o=n(5709);t.A=void 0;var a=o(n(2032)),l=n(4848);t.A=(0,a.default)((0,l.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},7034:(e,t,n)=>{var o=n(5709);t.A=void 0;var a=o(n(2032)),l=n(4848);t.A=(0,a.default)((0,l.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},5273:(e,t,n)=>{var o=n(5709);t.A=void 0;var a=o(n(2032)),l=n(4848);t.A=(0,a.default)((0,l.jsx)("path",{d:"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"}),"Done")},1447:(e,t,n)=>{var o=n(5709);t.A=void 0;var a=o(n(2032)),l=n(4848);t.A=(0,a.default)((0,l.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error")},1225:(e,t,n)=>{var o=n(5709);t.A=void 0;var a=o(n(2032)),l=n(4848);t.A=(0,a.default)((0,l.jsx)("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3zm-1-4-1.41-1.41L13 12.17V4h-2v8.17L8.41 9.59 7 11l5 5z"}),"FileDownloadOutlined")},8738:(e,t,n)=>{var o=n(5709);t.A=void 0;var a=o(n(2032)),l=n(4848);t.A=(0,a.default)((0,l.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M7 13.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m5 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m5 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"}),"Pending")},2702:(e,t,n)=>{var o=n(5709);t.A=void 0;var a=o(n(2032)),l=n(4848);t.A=(0,a.default)((0,l.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh")},5673:(e,t,n)=>{var o=n(5709);t.A=void 0;var a=o(n(2032)),l=n(4848);t.A=(0,a.default)((0,l.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")},2032:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.createSvgIcon}});var o=n(4009)}}]);