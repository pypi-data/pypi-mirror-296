<%!
import cpsar.controls as C
import cpsar.runtime as R

class GroupListBox(C.ListBox):
  def __init__(self):
    values=[('GROUPH', 'GROUPH'),
            ('GROUPPRC', 'GROUPPRC'),
            ('GROUPSKI', 'GROUPSKI'),
            ('GROUPMJO', 'GROUPMJO'),
            ('GROUPMSQ', 'GROUPMSQ'),
            ('GROUPSUN', 'GROUPSUN'),
            ('GROUPSPL', 'GROUPSPL'),
            ('CLINIC5',  'CLINIC5'),
            ('HELIOS',   'HELIOS'),
            ('ALIUS', 'ALIUS'),
            ('WAM', 'WAM')
            ]
    C.ListBox.__init__(self, 'group_number', values=values)

%>
<%inherit file="page.tmpl" />
<%block name="head">
  <title>Add PK Transaction</title>
  <link rel='stylesheet' type='text/css'
        href='/css/redmond/jquery-ui-1.8.14.custom.css' />
  <link rel='stylesheet' type='text/css' 
        href='/css/form.css' />
  <style type='text/css'>
    DIV.pk_lookup {
      display: none;
    }
  </style>
</%block>
<%def name='scripts()'>
  <script src='/js/jquery-1.5.1.min.js'></script> 
  <script type='text/javascript' src='/js/common.js'></script>
  <script src='/js/jquery.blockUI.js'></script>
  <script src='/js/jquery.numeric.js'></script>
  <script src='/js/jquery.vdate.js'></script>
  <script src='/js/jquery-ui-1.8.14.custom.min.js'></script>
  <script src='/repo/js/kcontrol/currency_control.js'></script>
  <script src='/js/import_pk.js'></script>
</%def>
<%block name="header">
  Add Pinnacle Transaction
</%block>
<div class='errors'></div>
<form action='/import_pk/add' method='POST' class='add'>
<table class='form'>
<tr>
  <td colspan='5' class='entry-header'>PK/Pinnacle Data</td>
</tr>
<tr>
    <td class='entry-caption'><label for='rxfill_id'>PK rxfill_id</td>
    <td class='entry-value'>${C.TextBox('rxfill_id')}</td>
    <td class='gutter'>&nbsp;</td>
    <td class='entry-caption'>&nbsp;</td>
    <td class='entry-value'><input type='button' class='pk_lookup' value='Lookup Data from PK'
    /></td>
</tr>
<tr>
    <td class='entry-caption'><label for='labor_cost'>Labor Cost</td>
    <td class='entry-value'>${C.TextBox('labor_cost', class_='numeric')}</td>
    <td class='gutter'>&nbsp;</td>
    <td class='entry-caption'><label for='shipping_cost'>Shipping Cost</td>
    <td class='entry-value'>${C.TextBox('shipping_cost', class_='numeric')}</td>
</tr>
<tr>
    <td class='entry-caption'><label for='drug_cost'>Drug Cost</td>
    <td class='entry-value'>${C.TextBox('drug_cost', class_='numeric')}</td>
    <td class='gutter'>&nbsp;</td>
    <td class='entry-caption'><label for='pharmacy_cost'>Pharmacy Cost</td>
    <td class='entry-value'>${C.TextBox('pharmacy_cost', class_='numeric')}</td>
</tr>
<tr>
  <td colspan='5' class='entry-header'>Blue Diamond Transaction Data</td>
</tr>
<tr>
    <td class='entry-caption'><label for='batch_date'>Batch Date</td>
    <td class='entry-value'>${C.TextBox('batch_date', class_='datepicker')}</td>
    <td class='gutter'>&nbsp;</td>
    <td class='entry-caption'><label for='create_date'>Create Date</td>
    <td class='entry-value'>${C.DatePicker('create_date', defaultToday=True)}</td>
</tr>
<tr>
    <td class='entry-caption'><label for='group_number'>Group Number</label>
    </td>
    <td class='entry-value'>${GroupListBox()}</td>
    <td class='gutter'>&nbsp;</td>
    <td class='entry-caption'><label for='group_auth'>Claim Reference Number
    (Group Auth #)</label>
    </td>
    <td class='entry-value'>${C.TextBox('group_auth', class_='numeric')}</td>
</tr>
<tr>
    <td class='entry-caption'><label for='invoice_id'>Invoice Number</label>
    </td>
    <td class='entry-value'>${C.TextBox('invoice_id', class_='numeric')}</td>
    <td class='gutter'>&nbsp;</td>
    <td class='entry-caption'><label for='line_no'>Invoice Line Number</label>
    </td>
    <td class='entry-value'>${C.TextBox('line_no', class_='numeric')}</td>
</tr>
<tr>
    <td class='entry-caption'><label for='patient_dob'>Patient DOB</label>
    </td>
    <td class='entry-value'>${C.DatePicker('patient_dob')}</td>
    <td class='gutter'>&nbsp;</td>
    <td class='entry-caption'><label for='patient_cardholder_nbr'>
      Patient Cardholder Number</label></td>
    <td class='entry-value'>${C.TextBox('patient_cardholder_nbr', maxlength=11)}</td>
</tr>
<tr>
    <td class='entry-caption'><label for='patient_id'>
      Patient ID (Internal BD Identifier)</label>
    </td>
    <td class='entry-value'>${C.TextBox('patient_id', class_='numeric')}</td>
    <td class='gutter'>&nbsp;</td>
    <td class='entry-caption'><label for='referring_nabp'>
      Referring NABP#</label></td>
    <td class='entry-value'>${C.TextBox('referring_nabp', maxlength=20)}</td>
</tr>
<tr>
    <td class='entry-caption'><label for='pharmacy_nabp'>
      Pharmacy NABP</label></td>
    <td class='entry-value'>
      ${C.ListBox('pharmacy_nabp', values=[(pharmacy_nabp, pharmacy_nabp)])}
    </td>
    <td class='gutter'>&nbsp;</td>
    <td class='entry-caption'><label for='pharmacy_id'>
      Pharmacy ID (Internal BD Identifier)</label>
    </td>
    <td class='entry-value'>
      ${C.ListBox('pharmacy_id', values=[(pharmacy_id, pharmacy_id)])}
    </td>
</tr>
<tr>
    <td class='entry-caption'><label for='doctor_dea_number'>
      Doctor DEA Number</label>
    </td>
    <td class='entry-value'>
      ${C.TextBox('doctor_dea_number')}
    </td>
    <td class='gutter'>&nbsp;</td>
    <td class='entry-caption'><label for='doctor_npi_number'>
      Doctor NPI Number</label>
    </td>
    <td class='entry-value'>
      ${C.TextBox('doctor_npi_number')}
    </td>
</tr>
<tr>
    <td class='entry-caption'><label for='doctor_dea_number'>
      Doctor Name</label>
    </td>
    <td class='entry-value'>
      ${C.TextBox('doctor_name')}
    </td>
    <td class='gutter'>&nbsp;</td>
</tr>
<tr>
    <td class='entry-caption'><label for='drug_ndc_number'>
      Drug NDC #</label>
    </td>
    <td class='entry-value'>
      ${C.ListBox('drug_ndc_number', values=[(drug_ndc, drug_ndc)])}
    </td>
    <td class='gutter'>&nbsp;</td>
    <td class='entry-caption'><label for='drug_id'>
      Drug ID (Internal BD Identifier)</label>
    </td>
    <td class='entry-value'>
      ${C.ListBox('drug_id', values=[(drug_id, drug_id)])}
    </td>
</tr>
<tr>
  <td class='entry-caption'><label for='rx_date'>RX Date</label></td>
  <td class='entry-value'>${C.DatePicker('rx_date')}</td>
  <td class='gutter'>&nbsp;</td>
  <td class='entry-caption'><label for='date_written'>Date Written</label></td>
  <td class='entry-value'>${C.DatePicker('date_written')}</td>
</tr>
<tr>
  <td class='entry-caption'><label for='rx_number'>RX Number</label></td>
  <td class='entry-value'>${C.TextBox('rx_number', class_='numeric')}</td>
  <td class='gutter'>&nbsp;</td>
  <td class='entry-caption'><label for='refill_number'>Refill Number</label></td>
  <td class='entry-value'>${C.TextBox('refill_number', class_='numeric')}</td>
</tr>
<tr>
  <td class='entry-caption'><label for='compound_code'>Compound Code</label></td>
  <td class='entry-value'>
      ${C.ListBox('compound_code', values=[('2', '2')])}
  </td>
  <td class='gutter'>&nbsp;</td>
  <td class='entry-caption'><label for='daw'>DAW</label></td>
  <td class='entry-value'>
    <% daw = [(i, i) for i in range(1, 10)] %>
    ${C.ListBox('daw', values=daw, blankOption=True)}</td>
</tr>
<tr>
  <td class='entry-caption'><label for='quantity'>Quantity</label></td>
  <td class='entry-value'>${C.TextBox('quantity', class_='numeric')}</td>
  <td class='gutter'>&nbsp;</td>
  <td class='entry-caption'><label for='days_supply'>Days Supply</label></td>
  <td class='entry-value'>${C.TextBox('days_supply', class_='numeric', maxlength='3')}</td>
</tr>
<tr>
  <td class='entry-caption'><label for='cost_submitted'>Cost Submitted</label></td>
  <td class='entry-value'>
      ${C.TextBox('cost_submitted', class_='numeric')}
  </td>
  <td class='gutter'>&nbsp;</td>
  <td class='entry-caption'><label for='cost_allowed'>Cost Allowed</label></td>
  <td class='entry-value'>
      ${C.TextBox('cost_allowed', class_='numeric')}
  </td>
</tr>
<tr>
  <td class='entry-caption'><label for='dispense_fee'>Dispense Fee</label></td>
  <td class='entry-value'>
      ${C.TextBox('dispense_fee', class_='numeric')}
  </td>
  <td class='gutter'>&nbsp;</td>
  <td class='entry-caption'><label for='processing_fee'>Processing Fee</label></td>
  <td class='entry-value'>
      ${C.TextBox('processing_fee', class_='numeric')}
  </td>
</tr>
<tr>
  <td class='entry-caption'><label for='sales_tax'>Sales Tax</label></td>
  <td class='entry-value'>
      ${C.TextBox('sales_tax', class_='numeric')}
  </td>
  <td class='gutter'>&nbsp;</td>
  <td class='entry-caption'><label for='eho_network_copay'>EHO Network Copay</label></td>
  <td class='entry-value'>
      ${C.TextBox('eho_network_copay', class_='numeric')}
  </td>
</tr>
<tr>
  <td class='entry-caption'><label for='usual_customary'>Usual &amp; Customary</label></td>
  <td class='entry-value'>
      ${C.TextBox('usual_customary', class_='numeric')}
  </td>
</tr>
<tr>
  <td class='entry-caption'><label for='state_fee'>State Fee</label></td>
  <td class='entry-value'>
      ${C.TextBox('state_fee', class_='numeric')}
  </td>
  <td class='gutter'>&nbsp;</td>
  <td class='entry-caption'><label for='awp'>AWP</label></td>
  <td class='entry-value'>
      ${C.TextBox('awp', class_='numeric')}
  </td>
</tr>
<tr>
  <td class='entry-caption'><label for='total'>Total</label></td>
  <td class='entry-value'>
      ${C.TextBox('total', class_='numeric')}
  </td>
  <td class='gutter'>&nbsp;</td>
  <td class='entry-caption'><label for='balance'>Balance</label></td>
  <td class='entry-value'>
      ${C.TextBox('balance', class_='numeric')}
  </td>
</tr>
<tr>
  <td class='entry-caption'><label for='savings'>Savings</label></td>
  <td class='entry-value'>
      ${C.TextBox('savings', class_='numeric')}
  </td>
</tr>
<tr>
  <td class='entry-caption'><label for='tx_type'>TX Type</label></td>
  <td class='entry-value'>
      ${C.ListBox('tx_type', values=[('MC', 'MC'), ('PC', 'PC'), ('GH', 'GH')])}
  </td>
  <td class='gutter'>&nbsp;</td>
  <td class='entry-caption'>
    <label for=''>History ID (Internal BD Identifier)</label></td>
  <td class='entry-value'>
      AUTO CREATE &amp; ASSIGN
  </td>
</tr>
<tr>
  <td class='entry-caption'></td>
  <td class='entry-value'><input type='submit' value='Add' /></td>
</tr>
</table>
</form>

<div class='pk_lookup'>
<form class='pk_lookup'>
<table class='form'>
<tr>
  <td class='entry-caption'><label for='pk_rx_number'>RX Number</label></td>
  <td class='entry-value'><input type='text' name='pk_rx_number' id='pk_rx_number' /></td>
  <td class='entry-value'>${GroupListBox()}</td>
  <td><input type='submit' value='Lookup' /></td>
</tr>
</table>
</form>
<div class='pk_results'></div>
</div>

