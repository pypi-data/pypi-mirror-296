<%!
import kcontrol as K
import cpsar.controls
layout="layout-3"
%>
<%inherit file='page.tmpl' />
<%block name='head'>
  <title>Post Payment</title>
  <link type='text/css' rel='stylesheet' 
        href='/css/jquery.autocomplete.css' />
  <link type='text/css' rel='stylesheet' href='/css/base.css' />
  <link type='text/css' rel='stylesheet' href='/css/pager.css' />
  <link type='text/css' rel='stylesheet' href='/css/form.css' />
  <link type='text/css' rel='stylesheet' href='/css/ppayment.css' />
  <link type='text/css' rel='stylesheet' href='/css/facebox.css' />
</%block>
<%def name='scripts()'>
  <script type='text/javascript'
          src='/js/jquery-1.5.1.min.js'></script>
  <script type='text/javascript'
          src='/js/jquery.numeric.js'></script>
  <script type='text/javascript'
          src='/js/jquery.autocomplete.js'></script>
  <script type='text/javascript' 
          src='/js/jquery.blockUI.js'></script>
  <script type='text/javascript'
          src='/js/facebox.js'></script>
  <script type='text/javascript' 
          src='/js/ppayment.js'></script>
</%def>
<%block name='header'>Post Payment</%block>

<%block name="topcontextmenu">
 <div class='content_header'>
  <table cellspacing='0' cellpadding='0' border='0' class='content_header'>
  <tr>
    <td align='right'> 
       <select id='payment_select'>
            <option value=''>Payment</option>
       </select>
       <input type='button' id='remove_payment_button' value='Remove'
              class='button top_menu_link' />

         <input type='button'
           id='use_payment_button'
           class='button top_menu_link'
           accesskey='a'
           value='Use' />
    </td>
    <td align='right'>
       <span class='top_label'>Amount</span>
       <input type='text' class='currency_display' id='current_amount'
              title='current_amount' />

       <span class='top_label'>Left</span>
       <input type='text' class='currency_display' 
              id='current_left_to_apply' title='current_left_to_apply' />

       <span class='top_label'>Applied</span>
       <input type='text' class='currency_display'
              title='current_total_applied' id='current_total_applied' />

       <span class='top_button'>
        <input type='button'
              id='reset_button'
              class='button top_menu_link'
              value="Reset" />
       </span>

       <span class='top_button'>
        <input type='button'
              id='post_button'
              class='button top_menu_link'
              accesskey='p'
              value="Post" />
       </span>

    </td>
   </tr>
   <tr>
    <td class='entry_date' align='right'>
      <div class='entry_date'>
        ${K.DatePicker('entry_date')}
     </div>  
     <label class='entry_date' for='entry_date'>Entry date</label>
    </td>
    <td class='previous_trans'>
   </td>
  </tr>
 </table>
</div>
</%block>
<%block name="left_menu">
    <table class='form top' id='left_menu_table'>
        <tr>
            <th colspan='2'>Post Payment</th>
        </tr>
        <tr>
            <td class='entry-caption'>
              <select name='ptype_id' id='ptype_id'>
                % for group_number, ptypes in payment_types:
                 % if group_number:
                   <optgroup label="${group_number}">
                   % for ptype in ptypes:
                    <option value='${ptype['ptype_id']}'
                            data-type-name="${ptype['type_name'] |h}"
                            data-group-number='${group_number}'
                            title='${ptype['default_ref_no']}'>
                         ${ptype['caption']}
                    </option>
                   % endfor
                   </optgroup>
                 % else:
                   % for ptype in ptypes:
                    <option value='${ptype['ptype_id']}'
                            data-type-name="${ptype['type_name'] |h}"
                            title='${ptype['default_ref_no']}'>
                         ${ptype['caption']}
                    </option>
                   % endfor
                 % endif
                % endfor
              </select>
            </td>
            <td class='entry-value'>
                ${K.TextBox('ref_no')}
            </td>
        </tr>
        <tr>
            <td class='entry-caption'>
                <label for='amount'>Amount</label>
            </td>
            <td class='entry-value'>
                ${K.TextBox('payment_amount')}
                <input type='button'
                        class='button top_menu_link'
                        id='add_payment_button'
                        value='Add'>
            </td>
        </tr>
        <tr>
            <th colspan='2'>Search Parameters</th>
        </tr>
        <tr>
            <td colspan='2' class='entry-caption left'>
                <label for='invoice_id'>Invoice #</label></td>
        </tr>
        <tr>
            <td colspan='2' class='entry-value'>
                ${K.TextBox('invoice_id')}
                ${K.TextBox('invoice_line_no', maxlength=3)}
            </td>
        </tr>
        <tr>
            <td colspan='2' class='entry-caption left'>
                <label for='rx_number'>Rx #</label></td>
        </tr>
        <tr>
            <td colspan='2' class='entry-value'>
                ${K.TextBox('rx_number')}
            </td>
        </tr>
        <tr>
            <td colspan='2' class='entry-caption left'>
                <label for='payer_code'>Payer Code</label></td>
        </tr>
        <tr>
            <td colspan='2' class='entry-value'>
                ${K.TextBox('payer_code')}
            </td>
        </tr>

        <tr>
            <td colspan='2' class='entry-caption left'>
                <label for='hbs_order_number'>HBS Order Number</label></td>
        </tr>
        <tr>
            <td colspan='2' class='entry-value'>
                ${K.TextBox('hbs_order_number')}
            </td>
        </tr>

        <tr>
            <td colspan='2' class='entry-caption left'>
                <label for='trans_group_number'>Client</label></td>
        </tr>
        <tr>
            <td colspan='2' class='entry-value'>
                ${cpsar.controls.GroupNumberListBox('group_number', 
                                                    blankOption=True)}
            </td>
        </tr>
        <tr>
            <td colspan='2' class='entry-caption left'>
                <label for='trans_report_code'>Report Code</label></td>
        </tr>
        <tr>
            <td colspan='2' class='entry-value'>
              ${K.TextBox("trans_report_code")}
            </td>
        </tr>
        <tr>
            <td colspan='2' class='entry-caption left'>
                <label for='patient_last_name'>Patient Last Name</label></td>
        </tr>
        <tr>
            <td colspan='2' class='entry-value'>
                ${K.TextBox('patient_last_name')}</td>
        </tr>
        <tr>
            <td colspan='2' class='entry-caption left'>
                <label for='patient_last_name'>Patient First Name</label></td>
        </tr>
        <tr>
            <td colspan='2' class='entry-value'>
                ${K.TextBox('patient_first_name')}</td>
        </tr>
        <tr>
            <td colspan='2' class='entry-caption left'>
                <label for='trans_group_auth'>Auth #</label></td>
        </tr>
        <tr>
            <td colspan='2' class='entry-value'>
                ${K.TextBox('trans_group_auth', maxlength=7)}
            </td>
        </tr>
        <tr>
            <td colspan='2' class='entry-caption left'>
                <label for='batch_date'>Batch Date</label></td>
        </tr>
        <tr>
            <td colspan='2' class='entry-value'>
                ${K.DatePicker('batch_date')}</td>
        </tr>
        <tr>
            <td colspan='2' class='entry-caption left'>
                <label for='invoice_date'>Invoice Date</label></td>
        </tr>
        <tr>
            <td colspan='2' class='entry-value'>
              <table cellpadding='0' cellspacing='0'>
                  <tr>
                    <td>${K.DatePicker('invoice_date')}</td>
                      <td>
                        &nbsp;
                        <input type='button' 
                            class='button top_menu_link'
                            id='search_button'
                            value='Search' />
                       </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</%block>

 <div id='transaction_container'>
 <table class='payment' id='post_table' 
    border='0' cellpadding='0' cellspacing='0'>
 <thead>
 <tr class='pager-header'>
    <td class='pager-header left' nowrap='nowrap'>Rx Date</td>
    <td class='pager-header left' nowrap='nowrap'>Batch Date</td>
    <td class='pager-header left' nowrap='nowrap'>Invoice</td>
    <td class='pager-header left' nowrap='nowrap'>Rx Number</td>
    <td class='pager-header left' nowrap='nowrap'>Payer Code</td>
    <td class='pager-header left' nowrap='nowrap'>Ref</td>
    <td class='pager-header left' nowrap='nowrap'>Patient</td>
    <td class='pager-header left' nowrap='nowrap'>Drug</td>
    <td class='pager-header right' nowrap='nowrap' colspan='2'>Balance</td>
    <td class='pager-header right' nowrap='nowrap'>Applied</td>
    <td class='pager-header right' nowrap='nowrap'></td>
 </tr>
 <tr id='trans_row_tmpl' class='transdata'>
    <td class='trans tpad'>
        <span class='rx_date'>MM/DD/YYYY</span>
    </td>
    <td class='trans tpad'>
        <span class='batch_date'>MM/DD/YYYY</span>
    </td>
    <td class='trans tpad'>
        <span class='invoice_ref'>INVOICE-LN</span>
    </td>
    <td class='trans tpad'>
        <span class='rx_number'>111111</span>
    </td>
    <td class='trans tpad'>
        <span class='payer_code'>1111111111</span>
    </td>
    <td class='trans tpad'>
        <span class='group_ref'>56500-0004</span>
    </td>
    <td class='trans tpad'>
        <span class='patient_first_name'>JOHN</span>
        <span class='patient_last_name'>SMITH</span>
    </td>
    <td class='trans'>
        <span class='drug_name'>DRUG NAME</span>
    </td>
    <td class='trans right tpad'>
        <span class='balance'>BAL</span>
    </td>
 
    <td class='trans' width='1'>
      <div class='round_button'>
        <span class='red_button'>
            <img src='/images/red.png' border='0' />
        </span>
        <span class='blue_button'>
            <img src='/images/blue.gif' border='0' />
        </span>
      </div>
    </td>
    <td class='trans right'>
        <input type='text'
               class='applied'
               value='$0.00'
         />
    </td>
    <td class='trans'>
        <input type='text' class='amount' />
    </td>
 </tr>
 </thead>
 <tbody>
 </tbody>
 </table>
 </div>
