"use strict";sap.ui.define(["sap/base/Log","./BaseController","./utils/Cookies"],function(n,e,t){"use strict";function i(n){return n&&n.__esModule&&typeof n.default!=="undefined"?n.default:n}const o=i(e);const s=t["getCSRFCookie"];const a=o.extend("demo.spa.controller.SignIn",{constructor:function e(){o.prototype.constructor.apply(this,arguments);this.logger=n.getLogger(a.getMetadata().getName())},_:function n(){this.onInit()},onCloseSignInDialog:function n(){this.signInDialog.close()},onInit:function n(){o.prototype.onInit.call(this);this.getRouter().attachRoutePatternMatched(n=>{if(n.getParameter("name")=="SIGN IN FULLSCREEN"){this.openSignInDialog()}})},onSignInPress:function n(){const e=this.getFrontendModel().getProperty("/loginForm");if(e.username&&e.password){this.signInDialog.setBusy(true);o.connector.signIn(e).then(n=>this.handleLoginSuccess(n),this.handleSignInFailure.bind(this))}},openSignInDialog:function n(){if(!s()){void this.noCSRFTokenMessageBox();return}else if(this.signInDialog){this.signInDialog.open()}else{this.loadFragment({name:"demo.spa.view.SignInDialog"}).then(n=>{this.signInDialog=n;this.signInDialog.attachBeforeClose(()=>{this.getFrontendModel().setProperty("/loginForm/password","");this.navToHome()});this.signInDialog.open()}).catch(n=>{this.logger.error(String(n))})}},handleLoginSuccess:function n(e){let t="???";let i="!?!";e.json().then(n=>{if(n.username){t=n.username;i=n.user_id}this.loginUser(t,i);this.getUserDataModel().fetch(["person","slot","appointment"])}).catch(n=>{this.logger.error(String(n))}).finally(()=>{this.signInDialog.setBusy(false);this.signInDialog.close()})},handleSignInFailure:function n(e){this.signInDialog.setBusy(false);this.failedResponseToMessageBox(e)}});return a});
//# sourceMappingURL=SignIn.controller.js.map