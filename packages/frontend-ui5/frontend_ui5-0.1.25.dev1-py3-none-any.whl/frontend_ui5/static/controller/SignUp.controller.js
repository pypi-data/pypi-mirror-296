"use strict";sap.ui.define(["sap/base/Log","sap/m/MessageToast","./BaseController","./utils/Cookies","./utils/Formatters"],function(t,e,i,s,n){"use strict";function o(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}const a=o(i);const r=s["getCSRFCookie"];const l=n["getEmailAddressErrorState"];const g=a.extend("demo.spa.controller.SignUp",{constructor:function e(){a.prototype.constructor.apply(this,arguments);this.logger=t.getLogger(g.getMetadata().getName());this.getEmailAddressErrorState=l},_:function t(){this.onInit()},onCloseSignUpDialog:function t(){this.signUpDialog.close();this.navToHome()},onInit:function t(){a.prototype.onInit.call(this);this.getRouter().attachRoutePatternMatched(t=>{if(t.getParameter("name")=="SIGN UP FULLSCREEN"){this.openSignUpDialog()}})},onSignUpPress:function t(){const e=this.getFrontendModel().getProperty("/signUpForm");if(this.validateSignUpForm(e)){this.signUpDialog.setBusy(true);a.connector.signUp(e).then(t=>this.handleSignUpSuccess(t),this.handleSignUpFailure.bind(this))}},handleSignUpFailure:function t(e){this.signUpDialog.setBusy(false);this.failedResponseToMessageBox(e)},handleSignUpSuccess:function t(i){e.show("Signed up successfully");i.json().then(t=>{this.loginUser(t.username,t.user_id)}).catch(t=>{this.logger.error(String(t))}).finally(()=>{this.signUpDialog.setBusy(false);this.navToHome()})},openSignUpDialog:function t(){if(!r()){void this.noCSRFTokenMessageBox();return}else if(this.signUpDialog){this.getFrontendModel().setProperty("/signUpForm",{...g.initialSignUpData});this.signUpDialog.open()}else{this.loadFragment({name:"demo.spa.view.SignUpDialog"}).then(t=>{this.signUpDialog=t;this.getFrontendModel().setProperty("/signUpForm",{...g.initialSignUpData});this.signUpDialog.attachBeforeClose(()=>{this.getFrontendModel().setProperty("/signUpForm",{...g.initialSignUpData})});this.signUpDialog.open()}).catch(t=>{this.logger.error(String(t))})}},validateSignUpForm:function t(i){const{username:s,email:n,password:o,password_confirmation:a}=i;if(s&&n&&o&&a){if(o!==a){e.show("Passwords do not match");return false}if(this.getEmailAddressErrorState(n)!=="None"){e.show("Email is not valid");return false}return true}else{e.show("Please fill out all required fields");return false}}});g.initialSignUpData={username:"",email:"",password:"",password_confirmation:"",product_key:""};g.setInitialSignUpData=function t(e){this.initialSignUpData=e};return g});
//# sourceMappingURL=SignUp.controller.js.map