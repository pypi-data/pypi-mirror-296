"use strict";(self.webpackChunk_jupytercad_jupytercad_lab=self.webpackChunk_jupytercad_jupytercad_lab||[]).push([[484],{484:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var r=a(959),o=a(973),n=a(909),d=a(314),s=a(241),i=a(678),l=a(796),c=a(473),u=a(354),p=a(230),g=a(256),y=a(677);class h extends y.JupyterYModel{}class M extends g.Panel{constructor(e){super(),this.onResize=()=>{this._jcadWidget&&p.MessageLoop.sendMessage(this._jcadWidget,g.Widget.ResizeMessage.UnknownSize)},this.addClass("jupytercad-notebook-widget"),this._jcadWidget=new r.JupyterCadPanel(e),this.addWidget(this._jcadWidget)}}const C={id:"jupytercad:yjswidget-plugin",autoStart:!0,requires:[o.IJCadWorkerRegistryToken],optional:[y.IJupyterYWidgetManager,i.ITranslator],activate:(e,t,a,r)=>{if(!a)return void console.error("Missing IJupyterYWidgetManager token!");const n=null!=r?r:i.nullTranslator;a.registerWidget("@jupytercad:widget",class extends h{ydocFactory(t){const{path:a,format:r,contentType:d}=t;this.jupyterCADModel=new o.JupyterCadModel({});const s=e.serviceManager.user;if(a&&r&&d){const e=u.ServerConnection.makeSettings(),t=c.URLExt.join(e.wsUrl,"api/collaboration/room"),o=new l.WebSocketProvider({url:t,path:a,format:r,contentType:d,model:this.jupyterCADModel.sharedModel,user:s,translator:n.load("jupyterlab")});this.jupyterCADModel.disposed.connect((()=>{o.dispose()}))}else{const e=this.jupyterCADModel.sharedModel.awareness,t=t=>{e.setLocalStateField("user",t.identity)};s.ready.then((()=>{t(s)})).catch((e=>console.error(e))),s.userChanged.connect(t,this)}return this.jupyterCADModel.sharedModel.ydoc}},class{constructor(e,a){this.yModel=e,this.node=a;const r=new M({model:e.jupyterCADModel,workerRegistry:t});p.MessageLoop.sendMessage(r,g.Widget.Msg.BeforeAttach),a.appendChild(r.node),p.MessageLoop.sendMessage(r,g.Widget.Msg.AfterAttach)}})}},m="jupytercad",j=[{id:"jupytercad:lab:main-menu",autoStart:!0,requires:[o.IJupyterCadDocTracker,o.IJCadFormSchemaRegistryToken,o.IJCadWorkerRegistryToken],optional:[s.IMainMenu,i.ITranslator,d.ICompletionProviderManager],activate:(e,t,a,o,n,d,s)=>{console.log("jupytercad:lab:main-menu is activated!"),d=null!=d?d:i.nullTranslator;(0,r.addCommands)(e,t,d,a,o,s),n&&function(e,t){e.fileMenu.addItem({command:r.CommandIDs.exportJcad}),e.editMenu.undoers.redo.add({id:r.CommandIDs.redo,isEnabled:t}),e.editMenu.undoers.undo.add({id:r.CommandIDs.undo,isEnabled:t})}(n,(()=>null!==t.currentWidget&&t.currentWidget===e.shell.currentWidget))}},{id:"jupytercad:lab:controlpanel",autoStart:!0,requires:[n.ILayoutRestorer,o.IJupyterCadDocTracker,o.IAnnotationToken,o.IJCadFormSchemaRegistryToken],activate:(e,t,a,o,n)=>{const d=new r.ControlPanelModel({tracker:a}),s=new r.LeftPanelWidget({model:d,annotationModel:o,tracker:a});s.id="jupytercad::leftControlPanel",s.title.caption="JupyterCad Control Panel",s.title.icon=r.jcLightIcon;const i=new r.RightPanelWidget({model:d,tracker:a,formSchemaRegistry:n});i.id="jupytercad::rightControlPanel",i.title.caption="JupyterCad Control Panel",i.title.icon=r.jcLightIcon,t&&(t.add(s,m),t.add(i,m)),e.shell.add(s,"left",{rank:2e3}),e.shell.add(i,"right",{rank:2e3})}},C]}}]);